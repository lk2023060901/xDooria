syntax = "proto3";

package user;

import "buf/validate/validate.proto";

option go_package = "github.com/lk2023060901/xdooria/examples/grpc/proto/user";

// UserService 用户服务
service UserService {
  // CreateUser 创建用户
  rpc CreateUser (CreateUserRequest) returns (CreateUserResponse) {}

  // GetUser 获取用户
  rpc GetUser (GetUserRequest) returns (GetUserResponse) {}
}

// CreateUserRequest 创建用户请求
message CreateUserRequest {
  // 用户名：3-50 个字符，只允许字母数字下划线
  string username = 1 [(buf.validate.field).string = {
    min_len: 3,
    max_len: 50,
    pattern: "^[a-zA-Z0-9_]+$"
  }];

  // 邮箱：必须是有效的邮箱格式
  string email = 2 [(buf.validate.field).string.email = true];

  // 年龄：0-150 岁
  int32 age = 3 [(buf.validate.field).int32 = {
    gte: 0,
    lte: 150
  }];
}

// CreateUserResponse 创建用户响应
message CreateUserResponse {
  int64 user_id = 1;
  string message = 2;
}

// GetUserRequest 获取用户请求
message GetUserRequest {
  int64 user_id = 1;
}

// GetUserResponse 获取用户响应
message GetUserResponse {
  int64 user_id = 1;
  string username = 2;
  string email = 3;
  int32 age = 4;
}
