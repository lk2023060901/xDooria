version: "3.8"

services:
  nginx:
    image: nginx:1.25-alpine
    container_name: xdooria-nginx
    ports:
      - "80:80"       # HTTP (重定向到 HTTPS)
      - "443:443"     # HTTPS
      - "9000:9000"   # gRPC (TLS)
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./certs:/etc/nginx/ssl:ro
      - /var/www/static:/var/www/static:ro
    deploy:
      resources:
        limits:
          cpus: "2"
          memory: 1G
        reservations:
          cpus: "0.5"
          memory: 256M
    restart: always
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "5"
